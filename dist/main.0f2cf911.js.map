{"version":3,"sources":["main.js"],"names":["date","buttonlist","document","querySelector","show","pause","play","replay","stop","triggerButton","Event","currentTime","endTime","getCurrentTime","Date","getHours","getMinutes","getSeconds","getTime","getEndTime","seconds","minutes","Math","floor","hours","calcSeconds","x","changeTitle","timeoutId","keywords","keyArray","split","tick","intervalId","setInterval","Promise","resolve","then","push","shift","title","join","clearInterval","addClass","target","indexOf","id","classList","add","remove","removeClass","setTimeout","timeObj","historyTime","restSeconds","init","clear","refresh","timer","clearTimeout","confirm","console","log","textContent","diff","minute","call","dispatchEvent","bind","addEventListener","e"],"mappings":"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","file":"main.0f2cf911.js","sourceRoot":"..\\src","sourcesContent":["const buttonlist = document.querySelector(\".buttonList\");\r\nconst show = document.querySelector(\".show\");\r\nconst pause = document.querySelector(\"#pause\");\r\nconst play = document.querySelector(\"#play\");\r\nconst replay = document.querySelector(\"#replay\");\r\nconst stop = document.querySelector(\"#stop\");\r\nconst triggerButton = new Event(\"click\");\r\n\r\nlet date; //date不能为常量\r\nlet currentTime = [null, null, null, null];\r\nlet endTime = [null, null, null];\r\nconst getCurrentTime = () => {\r\n    date = new Date();\r\n    currentTime = [\r\n        date.getHours(),\r\n        date.getMinutes(),\r\n        date.getSeconds(),\r\n        date.getTime()\r\n    ];\r\n};\r\nconst getEndTime = seconds => {\r\n    if (seconds) {\r\n        minutes = Math.floor((seconds + currentTime[2]) / 60);\r\n        endTime[2] = (seconds + currentTime[2]) % 60;\r\n        hours = Math.floor((minutes + currentTime[1]) / 60);\r\n        endTime[1] = (minutes + currentTime[1]) % 60;\r\n        endTime[0] = hours + currentTime[0];\r\n    } else {\r\n        if (currentTime[1] + 40 >= 60) {\r\n            endTime = [\r\n                currentTime[0] + 1,\r\n                (currentTime[1] + 40) % 60,\r\n                currentTime[2]\r\n            ];\r\n        } else {\r\n            endTime = [currentTime[0], currentTime[1] + 40, currentTime[2]];\r\n        }\r\n    }\r\n};\r\nconst calcSeconds = x => {\r\n    //转换成秒\r\n    return x[0] * 3600 + x[1] * 60 + x[2];\r\n};\r\nconst changeTitle = function() {\r\n    if (this.timeoutId === null) return;\r\n    const keywords = \"到点了！到点了！起来运动啦！起来运动啦！\";\r\n    let keyArray = keywords.split(\"\");\r\n    let tick = 0;\r\n    const tempF = function() {\r\n        return new Promise(resolve => {\r\n            resolve();\r\n        }).then(() => {\r\n            tick++;\r\n            keyArray.push(keyArray.shift());\r\n            document.title = keyArray.join(\"\");\r\n            if (tick === 80) {\r\n                clearInterval(intervalId);\r\n                document.title = \"计时器\";\r\n            }\r\n        });\r\n    };\r\n    const intervalId = setInterval(tempF, 70);\r\n};\r\nconst addClass = function(target) {\r\n    const selectButton = [\"stop\", \"pause\"];\r\n    if (selectButton.indexOf(target.id) >= 0) {\r\n        target.classList.add(\"selected\");\r\n        target.classList.remove(\"normal\");\r\n    }\r\n};\r\nconst removeClass = function() {\r\n    const target = document.querySelector(\".selected\");\r\n    if (target) {\r\n        target.classList.remove(\"selected\");\r\n        target.classList.add(\"normal\");\r\n        target.classList.add(\"animation-once\");\r\n        setTimeout(() => {\r\n            target.classList.remove(\"animation-once\");\r\n        }, 3000);\r\n    }\r\n};\r\nconst timeObj = {\r\n    historyTime: null,\r\n    restSeconds: null,\r\n    timeoutId: null,\r\n    intervalId: null,\r\n    init(seconds) {\r\n        this.clear();\r\n        this.refresh(seconds);\r\n        this.historyTime = calcSeconds(currentTime);\r\n        this.timer();\r\n    },\r\n    refresh(seconds) {\r\n        getCurrentTime();\r\n        getEndTime(seconds);\r\n    },\r\n    clear() {\r\n        if (this.timeoutId) {\r\n            clearTimeout(this.timeoutId);\r\n            this.timeoutId = null;\r\n        }\r\n        if (this.intervalId) {\r\n            clearInterval(this.intervalId);\r\n            this.intervalId = null;\r\n        }\r\n    },\r\n    pause() {\r\n        if (this.timeoutId) {\r\n            this.clear();\r\n            getCurrentTime();\r\n\r\n            this.restSeconds =\r\n                40 * 60 - (calcSeconds(currentTime) - this.historyTime);\r\n        }\r\n    },\r\n    play() {\r\n        if (this.restSeconds) {\r\n            this.init(this.restSeconds);\r\n            this.restSeconds = null;\r\n        } else if (this.timeoutId) {\r\n            const answer = confirm(\"当前正在计时，确定要重置吗？\");\r\n            answer ? this.init() : console.log();\r\n        }\r\n    },\r\n    stop() {\r\n        this.clear();\r\n        this.historyTime = null;\r\n        this.restSeconds = null;\r\n        show.textContent = \"0:\" + 40;\r\n    },\r\n    timer() {\r\n        this.intervalId = setInterval(() => {\r\n            getCurrentTime();\r\n            if (endTime[0] && endTime[1] && endTime[2]) {\r\n                let diff = calcSeconds(endTime) - calcSeconds(currentTime);\r\n                console.log(diff);\r\n                if (diff) {\r\n                    const minute = Math.floor(diff / 60);\r\n                    if (minute < 10) minute = \"0\" + minute;\r\n                    show.textContent = \"0:\" + minute;\r\n                } else {\r\n                    show.textContent = \"0:00\";\r\n                    show.classList.add(\"strong\");\r\n                    clearInterval(this.intervalId);\r\n                }\r\n            }\r\n        }, 1000);\r\n        this.timeoutId = setTimeout(\r\n            function() {\r\n                changeTitle.call(this);\r\n                document.title = \"计时器\";\r\n                setTimeout(() => {\r\n                    replay.dispatchEvent(triggerButton);\r\n                }, 3000);\r\n            }.bind(this),\r\n            this.restSeconds * 1000 || 40 * 60 * 1000\r\n        );\r\n    }\r\n};\r\nbuttonlist.addEventListener(\"click\", e => {\r\n    switch (e.target) {\r\n        case pause:\r\n            timeObj.pause();\r\n            removeClass();\r\n            addClass(e.target);\r\n            break;\r\n        case play:\r\n            timeObj.play();\r\n            removeClass();\r\n            break;\r\n        case stop:\r\n            timeObj.stop();\r\n            removeClass();\r\n            addClass(e.target);\r\n            break;\r\n        case replay:\r\n            removeClass();\r\n            timeObj.init();\r\n            break;\r\n        default:\r\n            console.log();\r\n    }\r\n});\r\ntimeObj.init();\r\nshow.textContent = \"0:\" + 40;\r\n"]}